name       : yarn
version    : 1.17.3
release    : 51
source     :
    - https://github.com/yarnpkg/yarn/archive/v1.17.3.tar.gz : 2bba1a63d4348fe4432f4cee6dc3911b98a4fef15ac7f227b91b139137ac03af
license    : BSD-2-Clause
component  : programming.tools
networking : yes
summary    : Fast, reliable, and secure dependency management for JavaScript.
description: |
    Fast, reliable, and secure dependency management for JavaScript.
builddeps  :
    - nodejs
rundeps    :
    - nodejs
build      : |
    npm install
    ln -s node_modules/gulp/bin/gulp.js gulp
    ./gulp build
install    : |
    export yarnModules="/usr/lib/node_modules/yarn/node_modules/"
    install -dm00644 $installdir/usr/bin
    install -dm00644 $installdir/usr/lib/node_modules/yarn
    # Pre-copy fix for node_modules/.bin/sshpk-* broken symbolic link
    rm node_modules/.bin/sshpk-*
    # Copy
    cp -R bin lib node_modules yarn.lock package.json $installdir/usr/lib/node_modules/yarn/
    ln -s /usr/lib/node_modules/yarn/bin/yarnpkg $installdir/usr/bin/yarn
    # Post-copy fix
    for f in sshpk-conv sshpk-sign sshpk-verify; do
        ln -s ${yarnModules}sshpk/bin/${f} $installdir/${yarnModules}.bin/${f}
    done
