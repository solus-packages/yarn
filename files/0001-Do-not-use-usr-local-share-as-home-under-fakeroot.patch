From deb15e225f4ac92798a3c02d53f438e7f48bdbcf Mon Sep 17 00:00:00 2001
From: Richard Weber <riche.weber@gmail.com>
Date: Thu, 13 Jul 2017 11:15:30 +0300
Subject: [PATCH 1/1] Do not use /usr/local/share as home under fakeroot

---
 src/util/user-home-dir.js | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/src/util/user-home-dir.js b/src/util/user-home-dir.js
index 07ca1af4..76e87e3e 100644
--- a/src/util/user-home-dir.js
+++ b/src/util/user-home-dir.js
@@ -4,8 +4,11 @@ import ROOT_USER from './root-user.js';
 
 const path = require('path');
 
-const userHomeDir = process.platform === 'linux' && ROOT_USER
-  ? path.resolve('/usr/local/share')
-  : require('os').homedir();
+const isNotFakeRoot = typeof process.env.FAKEROOTKEY === 'undefined';
+
+const userHomeDir =
+  process.platform === 'linux' && ROOT_USER && isNotFakeRoot
+    ? path.resolve('/usr/local/share')
+    : require('os').homedir();
 
 export default userHomeDir;
-- 
2.13.2

